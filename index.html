<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMO-VIH Pro | Atenci√≥n Farmac√©utica VIH</title>
    <meta name="description" content="Sistema avanzado de atenci√≥n farmac√©utica especializado en VIH usando modelo CMO">
    <meta name="keywords" content="VIH, farmacia, CMO, atenci√≥n farmac√©utica, adherencia">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .version-info {
            position: absolute;
            top: 10px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 25px;
            padding: 30px;
        }

        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
            height: fit-content;
        }

        .analysis-section {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .tools-section {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            height: fit-content;
        }

        .tool-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            border: 2px solid #e9ecef;
        }

        .score-calculator {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            margin-bottom: 20px;
        }

        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .score-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .score-value {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }

        .cmo-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            border-left: 6px solid;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
        }

        .cmo-card:hover {
            transform: translateY(-2px);
        }

        .capacidad {
            border-left-color: #e74c3c;
        }

        .motivacion {
            border-left-color: #f39c12;
        }

        .oportunidad {
            border-left-color: #27ae60;
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.5em;
            color: white;
        }

        .capacidad .card-icon {
            background: #e74c3c;
        }

        .motivacion .card-icon {
            background: #f39c12;
        }

        .oportunidad .card-icon {
            background: #27ae60;
        }

        .card-title {
            font-size: 1.5em;
            font-weight: 600;
            color: #2c3e50;
        }

        .priority-section {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .priority-badge {
            display: inline-block;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.5em;
            font-weight: bold;
            margin-top: 10px;
        }

        .priority-1 {
            background: #e74c3c;
        }

        .priority-2 {
            background: #f39c12;
        }

        .priority-3 {
            background: #27ae60;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: #e74c3c;
        }

        button {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(231, 76, 60, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #17a2b8, #138496);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745, #20a035);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffc107, #e0a800);
        }

        .btn-full {
            width: 100%;
            margin: 10px 0;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
        }

        select, input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #e74c3c;
        }

        .factor-list {
            display: grid;
            gap: 8px;
            margin-bottom: 15px;
        }

        .factor-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            border-left: 4px solid #e74c3c;
            font-size: 13px;
        }

        .report-template {
            background: #f8f9fa;
            border: 2px dashed #6c757d;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-line;
            max-height: 300px;
            overflow-y: auto;
            display: block;
        }

        .reminder-item {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            position: relative;
        }

        .reminder-date {
            font-weight: bold;
            color: #e17055;
        }

        .reminder-actions {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }

        .btn-small {
            padding: 5px 10px;
            font-size: 12px;
            margin: 0;
        }

        .tabs {
            display: flex;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 20px;
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .tab.active {
            border-bottom-color: #e74c3c;
            color: #e74c3c;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .hidden {
            display: none;
        }

        .objective-card {
            background: #fff5f5;
            border: 2px dashed #e74c3c;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
        }

        .interventions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .intervention-item {
            background: #e8f5e8;
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid #27ae60;
            font-size: 13px;
        }

        .dimension-header {
            background: #e74c3c;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 12px;
        }

        .footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 20px;
            font-size: 0.9em;
        }

        .github-badge {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #333;
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            text-decoration: none;
            font-size: 0.9em;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .github-badge:hover {
            background: #555;
            transform: scale(1.05);
        }

        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .github-badge {
                position: relative;
                top: auto;
                right: auto;
                display: block;
                margin: 10px auto;
                width: fit-content;
            }
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .version-info {
                position: relative;
                top: auto;
                right: auto;
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <a href="#" class="github-badge" onclick="alert('¬°Proximamente en GitHub!')">
        ‚≠ê Ver en GitHub
    </a>

    <div class="container">
        <div class="header">
            <div class="version-info">v1.2025</div>
            <h1>üî¨ CMO-VIH Pro</h1>
            <p>Sistema Avanzado de Atenci√≥n Farmac√©utica en VIH</p>
        </div>

        <div class="main-layout">
            <!-- SECCI√ìN DE ENTRADA -->
            <div class="input-section">
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('case')">üìã Caso</div>
                    <div class="tab" onclick="switchTab('score')">üßÆ Score</div>
                </div>

                <div id="caseTab" class="tab-content active">
                    <label for="caseText">üìã Descripci√≥n del Caso Cl√≠nico:</label>
                    <textarea id="caseText" placeholder="Introduce aqu√≠ el texto libre del caso cl√≠nico de paciente VIH..."></textarea>
                    <button onclick="analyzeCase()" class="btn-full">üîç Analizar Caso</button>
                    <button onclick="loadExample()" class="btn-secondary btn-full">üìö Cargar Ejemplo</button>
                </div>

                <div id="scoreTab" class="tab-content">
                    <h4>üßÆ Calculadora de Puntuaci√≥n CMO-VIH</h4>
                    
                    <div class="form-group">
                        <div class="dimension-header">üë§ Demogr√°ficas</div>
                        <div class="form-row">
                            <div>
                                <label>Embarazo</label>
                                <select id="embarazo">
                                    <option value="0">No embarazada</option>
                                    <option value="auto">Embarazada (Prioridad 1 autom√°tica)</option>
                                </select>
                            </div>
                            <div>
                                <label>Edad</label>
                                <select id="edad">
                                    <option value="0">&lt; 50 a√±os</option>
                                    <option value="1">&gt; 50 a√±os</option>
                                    <option value="3">&gt; 65 a√±os</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="dimension-header">üè• Cl√≠nicas</div>
                        <div class="form-row">
                            <div>
                                <label>Comorbilidades</label>
                                <select id="comorbilidades">
                                    <option value="0">Menos de 2 patolog√≠as</option>
                                    <option value="2">‚â• 2 patolog√≠as del mismo patr√≥n</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="dimension-header">üíä Farmacoterap√©uticas</div>
                        <div class="form-row">
                            <div>
                                <label>Polifarmacia</label>
                                <select id="polifarmacia">
                                    <option value="0">&lt; 6 medicamentos</option>
                                    <option value="3">‚â• 6 medicamentos (TAR incluido)</option>
                                </select>
                            </div>
                            <div>
                                <label>√çndice de complejidad</label>
                                <select id="complejidad">
                                    <option value="0">‚â§ 11.25</option>
                                    <option value="3">&gt; 11.25</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div>
                                <label>Adherencia al TAR</label>
                                <select id="adherenciaTAR">
                                    <option value="0">Buena adherencia</option>
                                    <option value="3">Adherencia sub√≥ptima</option>
                                </select>
                            </div>
                            <div>
                                <label>Adherencia a medicaci√≥n concomitante</label>
                                <select id="adherenciaConcomitante">
                                    <option value="0">Buena adherencia</option>
                                    <option value="2">Adherencia sub√≥ptima</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="dimension-header">üè• Uso de recursos sanitarios</div>
                        <div class="form-row">
                            <div>
                                <label>Hospitalizaciones</label>
                                <select id="hospitalizaciones">
                                    <option value="0">Ninguna en √∫ltimos 6 meses</option>
                                    <option value="2">‚â• 1 en √∫ltimos 6 meses</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="dimension-header">üß† Psicosociales</div>
                        <div class="form-row">
                            <div>
                                <label>Calidad de vida</label>
                                <select id="calidadVida">
                                    <option value="0">Normal</option>
                                    <option value="1">Afectada</option>
                                </select>
                            </div>
                            <div>
                                <label>Depresi√≥n</label>
                                <select id="depresion">
                                    <option value="0">No</option>
                                    <option value="2">S√≠</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div>
                                <label>Movilidad</label>
                                <select id="movilidad">
                                    <option value="0">Normal</option>
                                    <option value="1">Limitada</option>
                                </select>
                            </div>
                            <div>
                                <label>Abuso de sustancias</label>
                                <select id="abusoSustancias">
                                    <option value="0">No</option>
                                    <option value="2">S√≠ (drogas/alcohol)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="dimension-header">üß† Neurocognitivo-sensorial</div>
                        <div class="form-row">
                            <div>
                                <label>Deterioro neurocognitivo</label>
                                <select id="deterioroNeurocognitivo">
                                    <option value="0">No</option>
                                    <option value="2">Leve/Moderado/Grave</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="dimension-header">üë¥ Fragilidad</div>
                        <div class="form-row">
                            <div>
                                <label>Fragilidad</label>
                                <select id="fragilidad">
                                    <option value="0">No fr√°gil</option>
                                    <option value="2">Fr√°gil</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="dimension-header">üí∞ Socioecon√≥micas</div>
                        <div class="form-row">
                            <div>
                                <label>Aspectos socioecon√≥micos</label>
                                <select id="socioeconomico">
                                    <option value="0">Estables</option>
                                    <option value="2">Desfavorables (sin hogar, aislamiento, etc.)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="dimension-header">üìä Resultados de salud</div>
                        <div class="form-row">
                            <div>
                                <label>Carga viral</label>
                                <select id="cargaViral">
                                    <option value="0">Indetectable</option>
                                    <option value="4">Detectable</option>
                                </select>
                            </div>
                            <div>
                                <label>Objetivos farmacol√≥gicos comorbilidades</label>
                                <select id="objetivosFarmacologicos">
                                    <option value="0">Alcanzados</option>
                                    <option value="2">No alcanzados</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <button onclick="calculateExactScore()" class="btn-full">üßÆ Calcular Puntuaci√≥n</button>
                </div>
            </div>

            <!-- SECCI√ìN DE AN√ÅLISIS -->
            <div class="analysis-section">
                <div class="tool-card score-calculator">
                    <h3>üìä Puntuaci√≥n CMO-VIH</h3>
                    <div class="score-grid">
                        <div class="score-item">
                            <span class="score-value" id="totalScore">--</span>
                            <small>Total</small>
                        </div>
                        <div class="score-item">
                            <span class="score-value" id="clinicalScore">--</span>
                            <small>Cl√≠nica</small>
                        </div>
                        <div class="score-item">
                            <span class="score-value" id="pharmacotherapyScore">--</span>
                            <small>Farmacoterapia</small>
                        </div>
                        <div class="score-item">
                            <span class="score-value" id="psychosocialScore">--</span>
                            <small>Psicosocial</small>
                        </div>
                        <div class="score-item">
                            <span class="score-value" id="healthResultsScore">--</span>
                            <small>Resultados</small>
                        </div>
                    </div>
                </div>

                <div class="priority-section">
                    <h2>üè∑Ô∏è Estratificaci√≥n CMO</h2>
                    <div id="priorityResult">
                        <p>Realiza el an√°lisis para obtener la estratificaci√≥n</p>
                    </div>
                </div>

                <div class="cmo-card capacidad">
                    <div class="card-header">
                        <div class="card-icon">C</div>
                        <div class="card-title">CAPACIDAD</div>
                    </div>
                    <div id="capacidadContent">
                        <p>An√°lisis de factores cl√≠nicos, farmacoterap√©uticos y de salud...</p>
                    </div>
                </div>

                <div class="cmo-card motivacion">
                    <div class="card-header">
                        <div class="card-icon">M</div>
                        <div class="card-title">MOTIVACI√ìN</div>
                    </div>
                    <div id="motivacionContent">
                        <p>Evaluaci√≥n de adherencia, educaci√≥n y compromiso...</p>
                    </div>
                </div>

                <div class="cmo-card oportunidad">
                    <div class="card-header">
                        <div class="card-icon">O</div>
                        <div class="card-title">OPORTUNIDAD</div>
                    </div>
                    <div id="oportunidadContent">
                        <p>An√°lisis de recursos tecnol√≥gicos y coordinaci√≥n asistencial...</p>
                    </div>
                </div>
            </div>

            <!-- SECCI√ìN DE HERRAMIENTAS -->
            <div class="tools-section">
                <div class="tool-card">
                    <h3>üìÑ Informes Autom√°ticos</h3>
                    <button onclick="generateReport('complete')" class="btn-success btn-full">üìã Informe Completo</button>
                    <button onclick="generateReport('summary')" class="btn-warning btn-full">üìù Resumen HC</button>
                    <button onclick="generateReport('follow')" class="btn-secondary btn-full">üìÖ Plan Seguimiento</button>
                    
                    <div id="reportOutput" class="report-template hidden"></div>
                    <button id="copyReport" onclick="copyReport()" class="btn-full hidden">üìã Copiar Informe</button>
                </div>

                <div class="tool-card">
                    <h3>‚è∞ Recordatorios</h3>
                    <div class="form-row">
                        <div>
                            <label>Pr√≥xima cita</label>
                            <input type="date" id="nextAppointment">
                        </div>
                        <div>
                            <label>Tipo</label>
                            <select id="appointmentType">
                                <option>Presencial</option>
                                <option>Telem√°tica</option>
                                <option>Telef√≥nica</option>
                            </select>
                        </div>
                    </div>
                    <button onclick="addReminder()" class="btn-full">‚ûï Programar</button>
                    
                    <div id="remindersList"></div>
                </div>

                <div class="tool-card">
                    <h3>‚öôÔ∏è Configuraci√≥n</h3>
                    <label>üè• Logo del hospital</label>
                    <input type="file" id="logoUpload" accept="image/*" onchange="uploadLogo()">
                    
                    <div class="form-group">
                        <label>üë®‚Äç‚öïÔ∏è Farmac√©utico responsable</label>
                        <input type="text" id="pharmacistName" placeholder="Nombre del farmac√©utico">
                    </div>
                    
                    <div class="form-group">
                        <label>üè• Centro</label>
                        <input type="text" id="centerName" placeholder="Nombre del centro">
                    </div>
                    
                    <button onclick="saveConfig()" class="btn-full">üíæ Guardar Config</button>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>CMO-VIH Pro v1.2025 | Sistema de Atenci√≥n Farmac√©utica Especializada</p>
            <p>Desarrollado para optimizar el seguimiento farmacoterap√©utico en pacientes VIH</p>
            <p><strong>Creado por Ram√≥n Morillo - V1.2025</strong></p>
        </div>
    </div>

    <script>
        // Variables globales
        let currentPriority = 0;
        let currentScores = {
            total: 0,
            demographic: 0,
            clinical: 0,
            pharmacotherapy: 0,
            healthCare: 0,
            psychosocial: 0,
            neurocognitive: 0,
            frailty: 0,
            socioeconomic: 0,
            healthResults: 0
        };
        let reminders = [];
        let currentReport = '';
        let appConfig = {
            pharmacist: '',
            center: '',
            logo: ''
        };

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            loadConfig();
            loadReminders();
            loadExample();
            setTimeout(() => analyzeCase(), 100);
        });

        function switchTab(tabName) {
            // Quitar active de todos
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Activar el seleccionado
            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        function loadExample() {
            document.getElementById('caseText').value = `Var√≥n de 52 a√±os, diagnosticado de infecci√≥n por VIH hace 15 a√±os. Actualmente en tratamiento con bictegravir/tenofovir alafenamida/emtricitabina 1 comprimido al d√≠a.

Antecedentes: Diagn√≥stico a los 37 a√±os con carga viral de 150.000 copias/ml y CD4 de 280 cel/Œºl. Ha tenido varios cambios de tratamiento por efectos adversos. Comorbilidades: diabetes mellitus tipo 2, hipertensi√≥n arterial, dislipidemia. Presenta fragilidad seg√∫n criterios de Fried.

Situaci√≥n farmacoterap√©utica: Toma 8 medicamentos diarios (TAR + metformina + enalapril + atorvastatina + omeprazol + lorazepam + vitamina D + calcio). Refiere olvidos ocasionales del TAR (2-3 veces al mes). √çndice de complejidad: 13.2.

Situaci√≥n social: Vive solo. Nivel educativo b√°sico. Pensionista por invalidez. Antecedente de consumo de alcohol hasta hace 2 a√±os. Presenta s√≠ntomas depresivos leves. Utiliza smartphone b√°sico. Vive a 30 minutos del hospital.

Par√°metros actuales: Carga viral indetectable (<50 copias/ml). CD4: 450 cel/Œºl. HbA1c: 8.2%. TA: 145/90 mmHg. Colesterol total: 220 mg/dl. Presenta fatiga y deterioro cognitivo leve. Una hospitalizaci√≥n en los √∫ltimos 6 meses por descompensaci√≥n diab√©tica.`;
        }

        function calculateExactScore() {
            const scores = {
                demographic: 0,
                clinical: 0,
                pharmacotherapy: 0,
                healthCare: 0,
                psychosocial: 0,
                neurocognitive: 0,
                frailty: 0,
                socioeconomic: 0,
                healthResults: 0
            };

            // Embarazo - prioridad autom√°tica
            if (document.getElementById('embarazo').value === 'auto') {
                updatePriorityDisplay(1, 'auto');
                currentScores = { ...scores, total: 0 };
                updateScoreDisplay(currentScores);
                return;
            }

            // Variables demogr√°ficas
            scores.demographic += parseInt(document.getElementById('edad').value);

            // Variables cl√≠nicas
            scores.clinical += parseInt(document.getElementById('comorbilidades').value);

            // Variables farmacoterap√©uticas
            scores.pharmacotherapy += parseInt(document.getElementById('polifarmacia').value);
            scores.pharmacotherapy += parseInt(document.getElementById('complejidad').value);
            scores.pharmacotherapy += parseInt(document.getElementById('adherenciaTAR').value);
            scores.pharmacotherapy += parseInt(document.getElementById('adherenciaConcomitante').value);

            // Uso de recursos sanitarios
            scores.healthCare += parseInt(document.getElementById('hospitalizaciones').value);

            // Variables psicosociales
            scores.psychosocial += parseInt(document.getElementById('calidadVida').value);
            scores.psychosocial += parseInt(document.getElementById('depresion').value);
            scores.psychosocial += parseInt(document.getElementById('abusoSustancias').value);

            // Neurocognitivo-sensorial
            scores.neurocognitive += parseInt(document.getElementById('deterioroNeurocognitivo').value);

            // Fragilidad
            scores.frailty += parseInt(document.getElementById('fragilidad').value);

            // Socioecon√≥micas
            scores.socioeconomic += parseInt(document.getElementById('socioeconomico').value);

            // Resultados de salud
            scores.healthResults += parseInt(document.getElementById('cargaViral').value);
            scores.healthResults += parseInt(document.getElementById('objetivosFarmacologicos').value);

            const total = scores.demographic + scores.clinical + scores.pharmacotherapy + 
                         scores.healthCare + scores.psychosocial + scores.neurocognitive + 
                         scores.frailty + scores.socioeconomic + scores.healthResults;

            // Actualizar display
            currentScores = { ...scores, total };
            updateScoreDisplay(currentScores);

            // Determinar prioridad seg√∫n umbrales definidos en el estudio
            let priority = 3;
            if (total >= 15) priority = 1;
            else if (total >= 7) priority = 2;

            currentPriority = priority;
            updatePriorityDisplay(priority);
        }

        function updateScoreDisplay(scores) {
            document.getElementById('totalScore').textContent = scores.total;
            document.getElementById('clinicalScore').textContent = scores.clinical + scores.demographic + scores.healthCare + scores.neurocognitive + scores.frailty + scores.socioeconomic;
            document.getElementById('pharmacotherapyScore').textContent = scores.pharmacotherapy;
            document.getElementById('psychosocialScore').textContent = scores.psychosocial;
            document.getElementById('healthResultsScore').textContent = scores.healthResults;
        }

        function analyzeCase() {
            const caseText = document.getElementById('caseText').value;
            if (!caseText.trim()) {
                alert('Por favor, introduce un caso cl√≠nico para analizar');
                return;
            }

            // An√°lisis autom√°tico del texto
            const autoScores = analyzeTextForScores(caseText);
            updateScoreDisplay(autoScores);
            
            const priority = calculatePriorityFromText(caseText);
            currentPriority = priority;
            updatePriorityDisplay(priority);
            
            updateCapacidadAnalysis(caseText);
            updateMotivacionAnalysis(caseText);
            updateOportunidadAnalysis(caseText);
        }

        function analyzeTextForScores(text) {
            let scores = {
                total: 0,
                demographic: 0,
                clinical: 0,
                pharmacotherapy: 0,
                healthCare: 0,
                psychosocial: 0,
                neurocognitive: 0,
                frailty: 0,
                socioeconomic: 0,
                healthResults: 0
            };

            const lowerText = text.toLowerCase();

            // An√°lisis demogr√°fico
            if (lowerText.includes('a√±os')) {
                const ageMatch = text.match(/(\d+)\s*a√±os/);
                if (ageMatch) {
                    const age = parseInt(ageMatch[1]);
                    if (age > 65) scores.demographic += 3;
                    else if (age > 50) scores.demographic += 1;
                }
            }

            // An√°lisis cl√≠nico
            const comorbidities = ['diabetes', 'hipertensi√≥n', 'dislipidemia', 'cardiopat√≠a', 'nefropat√≠a', 'hepatopat√≠a'];
            let comorbCount = 0;
            comorbidities.forEach(comord => {
                if (lowerText.includes(comord)) comorbCount++;
            });
            if (comorbCount >= 2) scores.clinical += 2;

            // An√°lisis farmacoterap√©utico
            if (lowerText.includes('medicamentos') || lowerText.includes('f√°rmacos')) {
                const medMatch = text.match(/(\d+)\s*medicamentos/);
                if (medMatch && parseInt(medMatch[1]) >= 6) scores.pharmacotherapy += 3;
            }
            if (lowerText.includes('olvid') || lowerText.includes('adherencia sub√≥ptima') || lowerText.includes('incumplimiento')) {
                scores.pharmacotherapy += 3;
            }
            if (lowerText.includes('complejidad') || lowerText.includes('complejo')) {
                const complexMatch = text.match(/(\d+\.?\d*)/);
                if (complexMatch && parseFloat(complexMatch[1]) > 11.25) scores.pharmacotherapy += 3;
            }

            // Uso de recursos sanitarios
            if (lowerText.includes('hospitalizaci√≥n') || lowerText.includes('ingreso')) scores.healthCare += 2;

            // Psicosociales
            if (lowerText.includes('depresi√≥n') || lowerText.includes('depresivo')) scores.psychosocial += 2;
            if (lowerText.includes('alcohol') || lowerText.includes('drogas')) scores.psychosocial += 2;
            if (lowerText.includes('fatiga') || lowerText.includes('movilidad limitada')) scores.psychosocial += 1;

            // Neurocognitivo
            if (lowerText.includes('deterioro cognitivo') || lowerText.includes('cognitivo')) scores.neurocognitive += 2;

            // Fragilidad
            if (lowerText.includes('fr√°gil') || lowerText.includes('fragilidad')) scores.frailty += 2;

            // Socioecon√≥mico
            if (lowerText.includes('vive solo') || lowerText.includes('aislamiento') || lowerText.includes('pensionista')) scores.socioeconomic += 2;

            // Resultados de salud
            if (lowerText.includes('detectable') && !lowerText.includes('indetectable')) scores.healthResults += 4;
            if (lowerText.includes('objetivos no alcanzados') || lowerText.includes('mal control')) scores.healthResults += 2;

            scores.total = scores.demographic + scores.clinical + scores.pharmacotherapy + 
                          scores.healthCare + scores.psychosocial + scores.neurocognitive + 
                          scores.frailty + scores.socioeconomic + scores.healthResults;
            
            currentScores = scores;
            return scores;
        }

        function calculatePriorityFromText(text) {
            const score = currentScores.total;
            if (text.toLowerCase().includes('embaraz')) return 1;
            if (score >= 15) return 1;
            if (score >= 7) return 2;
            return 3;
        }

        function updatePriorityDisplay(priority, type = 'score') {
            const priorityResult = document.getElementById('priorityResult');
            let priorityText = '';
            let badgeClass = '';
            
            if (type === 'auto') {
                priorityText = 'PRIORIDAD 1 - AUTOM√ÅTICA';
                badgeClass = 'priority-1';
                priorityResult.innerHTML = `
                    <h3>Embarazo detectado</h3>
                    <div class="priority-badge ${badgeClass}">${priorityText}</div>
                    <p style="margin-top: 15px;">Atenci√≥n farmac√©utica prioritaria por embarazo</p>
                `;
            } else {
                switch(priority) {
                    case 1:
                        priorityText = 'PRIORIDAD 1 - ALTA';
                        badgeClass = 'priority-1';
                        break;
                    case 2:
                        priorityText = 'PRIORIDAD 2 - MEDIA';
                        badgeClass = 'priority-2';
                        break;
                    case 3:
                        priorityText = 'PRIORIDAD 3 - BAJA';
                        badgeClass = 'priority-3';
                        break;
                }
                
                const frequency = getFollowUpFrequency(priority);
                priorityResult.innerHTML = `
                    <h3>Puntuaci√≥n Total: ${currentScores.total}</h3>
                    <div class="priority-badge ${badgeClass}">${priorityText}</div>
                    <p style="margin-top: 15px;">Seguimiento: ${frequency}</p>
                `;
            }
        }

        function getFollowUpFrequency(priority) {
            switch(priority) {
                case 1: return 'Cada 3 meses';
                case 2: return 'Cada 6 meses';
                case 3: return 'Cada 12 meses';
                default: return 'Sin determinar';
            }
        }

        function updateCapacidadAnalysis(text) {
            const content = document.getElementById('capacidadContent');
            const lowerText = text.toLowerCase();
            
            let factors = [];
            
            if (lowerText.includes('carga viral detectable') || (lowerText.includes('detectable') && !lowerText.includes('indetectable'))) {
                factors.push('Carga viral detectable - Necesidad de optimizaci√≥n TAR');
            }
            if (lowerText.includes('olvid') || lowerText.includes('adherencia')) {
                factors.push('Problemas de adherencia identificados');
            }
            if (lowerText.includes('comorbilidad') || lowerText.includes('diabetes') || lowerText.includes('hipertensi√≥n')) {
                factors.push('M√∫ltiples comorbilidades presentes');
            }
            if (lowerText.includes('hospitalizaci√≥n') || lowerText.includes('ingreso')) {
                factors.push('Uso reciente de recursos sanitarios');
            }
            if (lowerText.includes('polifarmacia') || lowerText.includes('medicamentos')) {
                factors.push('R√©gimen farmacoterap√©utico complejo');
            }
            if (lowerText.includes('fr√°gil') || lowerText.includes('fragilidad')) {
                factors.push('Fragilidad detectada');
            }
            
            const interventions = [
                'Revisi√≥n y validaci√≥n del tratamiento TAR',
                'Seguimiento integral de adherencia TAR y medicaci√≥n concomitante',
                'Monitorizaci√≥n de interacciones medicamentosas',
                'Conciliaci√≥n farmacoterap√©utica en ingresos/altas',
                'Seguimiento de seguridad del tratamiento',
                'Revisi√≥n peri√≥dica de par√°metros de fragilidad'
            ];
            
            content.innerHTML = `
                <div class="factor-list">
                    ${factors.map(factor => `<div class="factor-item">‚Ä¢ ${factor}</div>`).join('')}
                </div>
                <div class="objective-card">
                    <strong>Objetivo:</strong> Optimizar resultados farmacoterap√©uticos y control de comorbilidades
                </div>
                <div class="interventions-grid">
                    ${interventions.map(int => `<div class="intervention-item">${int}</div>`).join('')}
                </div>
            `;
        }

        function updateMotivacionAnalysis(text) {
            const content = document.getElementById('motivacionContent');
            const lowerText = text.toLowerCase();
            
            let factors = [];
            
            if (lowerText.includes('depresi√≥n') || lowerText.includes('depresivo')) {
                factors.push('S√≠ntomas depresivos presentes');
            }
            if (lowerText.includes('alcohol') || lowerText.includes('drogas')) {
                factors.push('Antecedente de abuso de sustancias');
            }
            if (lowerText.includes('olvid') || lowerText.includes('adherencia')) {
                factors.push('Problemas de adherencia reportados');
            }
            if (lowerText.includes('educativo b√°sico') || lowerText.includes('nivel b√°sico')) {
                factors.push('Nivel educativo b√°sico');
            }
            if (lowerText.includes('vive solo') || lowerText.includes('aislamiento')) {
                factors.push('Situaci√≥n de aislamiento social');
            }
            if (lowerText.includes('pensionista') || lowerText.includes('invalidez')) {
                factors.push('Situaci√≥n laboral/econ√≥mica desfavorable');
            }
            
            const interventions = [
                'Educaci√≥n sobre VIH, TAR y rutas de transmisi√≥n',
                'Informaci√≥n sobre importancia de adherencia',
                'Promoci√≥n de estilos de vida saludables',
                'Estrategias de mejora de adherencia personalizadas',
                'Evaluaci√≥n de habilidades digitales',
                'Coordinaci√≥n con servicios de psicolog√≠a/psiquiatr√≠a',
                'Coordinaci√≥n con servicios sociales'
            ];
            
            content.innerHTML = `
                <div class="factor-list">
                    ${factors.map(factor => `<div class="factor-item">‚Ä¢ ${factor}</div>`).join('')}
                </div>
                <div class="objective-card">
                    <strong>Objetivo:</strong> Mejorar motivaci√≥n y compromiso con el tratamiento
                </div>
                <div class="interventions-grid">
                    ${interventions.map(int => `<div class="intervention-item">${int}</div>`).join('')}
                </div>
            `;
        }

        function updateOportunidadAnalysis(text) {
            const content = document.getElementById('oportunidadContent');
            const lowerText = text.toLowerCase();
            
            let factors = [];
            
            if (lowerText.includes('smartphone') || lowerText.includes('m√≥vil')) {
                factors.push('Acceso a tecnolog√≠a m√≥vil');
            }
            if (lowerText.includes('minutos') && lowerText.includes('hospital')) {
                factors.push('Distancia conocida al centro sanitario');
            }
            if (lowerText.includes('transporte') || lowerText.includes('acceso')) {
                factors.push('Consideraciones de accesibilidad');
            }
            if (lowerText.includes('familia') || lowerText.includes('cuidador')) {
                factors.push('Red de apoyo familiar disponible');
            }
            if (lowerText.includes('asociaci√≥n') || lowerText.includes('grupo')) {
                factors.push('Posible vinculaci√≥n con asociaciones');
            }
            
            const interventions = [
                'Consultas telem√°ticas cuando sea apropiado',
                'Herramientas de comunicaci√≥n r√°pida con paciente/familia',
                'Coordinaci√≥n con diferentes niveles asistenciales',
                'Coordinaci√≥n con asociaciones de pacientes',
                'Planificaci√≥n de visitas en coordinaci√≥n con especialistas',
                'Recomendaciones sobre apps y web para comprensi√≥n de patolog√≠a',
                'Establecimiento de circuitos de manejo farmacoterap√©utico'
            ];
            
            content.innerHTML = `
                <div class="factor-list">
                    ${factors.map(factor => `<div class="factor-item">‚Ä¢ ${factor}</div>`).join('')}
                </div>
                <div class="objective-card">
                    <strong>Objetivo:</strong> Optimizar coordinaci√≥n asistencial y recursos tecnol√≥gicos
                </div>
                <div class="interventions-grid">
                    ${interventions.map(int => `<div class="intervention-item">${int}</div>`).join('')}
                </div>
            `;
        }

        function generateReport(type) {
            const today = new Date().toLocaleDateString('es-ES');
            const caseText = document.getElementById('caseText').value;
            
            let report = '';
            
            switch(type) {
                case 'complete':
                    report = `INFORME FARMACOTERAP√âUTICO CMO-VIH
Fecha: ${today}
Farmac√©utico: ${appConfig.pharmacist || '[Nombre farmac√©utico]'}
Centro: ${appConfig.center || '[Nombre centro]'}

PUNTUACI√ìN CMO-VIH:
- Puntuaci√≥n total: ${currentScores.total}
- Variables demogr√°ficas: ${currentScores.demographic}
- Variables cl√≠nicas: ${currentScores.clinical}
- Variables farmacoterap√©uticas: ${currentScores.pharmacotherapy}
- Uso recursos sanitarios: ${currentScores.healthCare}
- Variables psicosociales: ${currentScores.psychosocial}
- Variables neurocognitivas: ${currentScores.neurocognitive}
- Variables de fragilidad: ${currentScores.frailty}
- Variables socioecon√≥micas: ${currentScores.socioeconomic}
- Resultados de salud: ${currentScores.healthResults}

ESTRATIFICACI√ìN: ${getPriorityText(currentPriority)}
FRECUENCIA DE SEGUIMIENTO: ${getFollowUpFrequency(currentPriority)}

AN√ÅLISIS CMO:

CAPACIDAD:
- Factores farmacoterap√©uticos y cl√≠nicos identificados
- Estado de la infecci√≥n por VIH y comorbilidades
- Complejidad del r√©gimen terap√©utico
- Necesidad de optimizaci√≥n de adherencia

MOTIVACI√ìN:
- Nivel de comprensi√≥n sobre VIH y tratamiento
- Factores psicosociales que influyen en adherencia
- Barreras para el cumplimiento terap√©utico
- Aspectos socioecon√≥micos relevantes

OPORTUNIDAD:
- Recursos tecnol√≥gicos y digitales disponibles
- Accesibilidad a servicios sanitarios
- Coordinaci√≥n con equipo multidisciplinar
- Vinculaci√≥n con asociaciones de pacientes

RECOMENDACIONES:
1. Seguimiento farmacoterap√©utico seg√∫n prioridad establecida
2. Educaci√≥n personalizada sobre VIH y tratamiento TAR
3. Optimizaci√≥n de adherencia mediante estrategias individualizadas
4. Monitorizaci√≥n de carga viral y par√°metros de comorbilidades
5. Coordinaci√≥n con equipo multidisciplinar (infectolog√≠a, psicolog√≠a, trabajo social)
6. Evaluaci√≥n peri√≥dica de efectividad y seguridad

PR√ìXIMAS ACTUACIONES:
- Revisi√≥n en consulta seg√∫n priorizaci√≥n CMO-VIH
- Monitorizaci√≥n de par√°metros virol√≥gicos e inmunol√≥gicos
- Evaluaci√≥n de objetivos farmacoterap√©uticos`;
                    break;
                    
                case 'summary':
                    report = `RESUMEN HISTORIA CL√çNICA - CMO-VIH
Fecha: ${today}

DATOS DEMOGR√ÅFICOS Y CL√çNICOS:
${caseText.substring(0, 200)}...

PUNTUACI√ìN CMO-VIH: ${currentScores.total}
PRIORIDAD: ${getPriorityText(currentPriority)}
SEGUIMIENTO: ${getFollowUpFrequency(currentPriority)}

PLAN TERAP√âUTICO:
- Continuidad del tratamiento TAR actual
- Seguimiento seg√∫n estratificaci√≥n CMO-VIH
- Educaci√≥n sanitaria personalizada sobre VIH
- Monitorizaci√≥n de adherencia y comorbilidades`;
                    break;
                    
                case 'follow':
                    report = `PLAN DE SEGUIMIENTO CMO-VIH
Fecha: ${today}
Paciente: [Nombre paciente]
Prioridad: ${getPriorityText(currentPriority)}

CRONOGRAMA DE SEGUIMIENTO:
${getFollowUpSchedule(currentPriority)}

OBJETIVOS DE SEGUIMIENTO:
1. Mantenimiento de carga viral indetectable
2. Adherencia terap√©utica √≥ptima al TAR
3. Control adecuado de comorbilidades
4. Calidad de vida mantenida
5. Prevenci√≥n de resistencias virales

INDICADORES DE SEGUIMIENTO:
- Carga viral VIH (objetivo: <50 copias/ml)
- Recuento CD4 (objetivo: >500 cel/Œºl)
- Adherencia al TAR (objetivo: >95%)
- Control de comorbilidades (HbA1c, TA, perfil lip√≠dico)
- Calidad de vida (escalas validadas)
- Eventos adversos y toxicidades

CONTACTOS PROGRAMADOS:
- Pr√≥xima consulta: [Fecha]
- Tipo de consulta: [Presencial/Telem√°tica]
- Frecuencia seg√∫n priorizaci√≥n CMO-VIH

INTERVENCIONES ESPEC√çFICAS:
Seg√∫n prioridad ${currentPriority}:
${getInterventionsByPriority(currentPriority)}`;
                    break;
            }
            
            currentReport = report;
            document.getElementById('reportOutput').textContent = report;
            document.getElementById('reportOutput').classList.remove('hidden');
            document.getElementById('copyReport').classList.remove('hidden');
        }

        function getPriorityText(priority) {
            switch(priority) {
                case 1: return 'PRIORIDAD 1 - ALTA';
                case 2: return 'PRIORIDAD 2 - MEDIA';
                case 3: return 'PRIORIDAD 3 - BAJA';
                default: return 'Sin determinar';
            }
        }

        function getFollowUpSchedule(priority) {
            switch(priority) {
                case 1: 
                    return `- Consulta inicial: Inmediata
- Primera revisi√≥n: 1 mes
- Revisiones posteriores: Cada 3 meses
- Contacto telef√≥nico: Quincenal primer mes
- Monitorizaci√≥n intensiva de carga viral y adherencia`;
                case 2:
                    return `- Consulta inicial: En 2 semanas
- Primera revisi√≥n: 2 meses
- Revisiones posteriores: Cada 6 meses
- Contacto telef√≥nico: Mensual si necesario
- Monitorizaci√≥n est√°ndar de par√°metros`;
                case 3:
                    return `- Consulta inicial: En 1 mes
- Primera revisi√≥n: 6 meses
- Revisiones posteriores: Cada 12 meses
- Contacto telef√≥nico: Seg√∫n necesidad
- Monitorizaci√≥n de rutina`;
                default:
                    return '- Programar seg√∫n evaluaci√≥n inicial';
            }
        }

        function getInterventionsByPriority(priority) {
            const interventions = {
                1: [
                    "Revisi√≥n y validaci√≥n del tratamiento TAR",
                    "Seguimiento integral de adherencia",
                    "Revisi√≥n de medicaci√≥n concomitante",
                    "Seguimiento de seguridad del tratamiento",
                    "Informaci√≥n sobre tratamiento y prevenci√≥n",
                    "Educaci√≥n sobre importancia de adherencia",
                    "Investigaci√≥n de habilidades digitales",
                    "Recomendaciones sobre apps y web",
                    "Planificaci√≥n de visitas con especialistas"
                ],
                2: [
                    "Revisi√≥n y validaci√≥n del tratamiento TAR",
                    "Seguimiento integral de adherencia",
                    "Revisi√≥n de medicaci√≥n concomitante",
                    "Conciliaci√≥n en ingresos/altas hospitalarias",
                    "Educaci√≥n sobre VIH y tratamiento",
                    "Informaci√≥n sobre adherencia",
                    "Promoci√≥n de estilos de vida saludables",
                    "Unificaci√≥n de criterios entre profesionales"
                ],
                3: [
                    "Revisi√≥n y validaci√≥n del tratamiento TAR",
                    "Seguimiento integral de adherencia",
                    "Revisi√≥n de medicaci√≥n concomitante"
                ]
            };
            
            return interventions[priority]?.map(int => `- ${int}`).join('\n') || '- Intervenciones seg√∫n evaluaci√≥n';
        }

        function copyReport() {
            navigator.clipboard.writeText(currentReport).then(() => {
                const btn = document.getElementById('copyReport');
                const originalText = btn.textContent;
                btn.textContent = '‚úÖ Copiado';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            }).catch(() => {
                alert('No se pudo copiar al portapapeles');
            });
        }

        function addReminder() {
            const date = document.getElementById('nextAppointment').value;
            const type = document.getElementById('appointmentType').value;
            
            if (!date) {
                alert('Por favor, selecciona una fecha');
                return;
            }
            
            const reminder = {
                id: Date.now(),
                date: date,
                type: type,
                created: new Date().toISOString()
            };
            
            reminders.push(reminder);
            saveReminders();
            loadReminders();
            
            // Limpiar campos
            document.getElementById('nextAppointment').value = '';
        }

        function loadReminders() {
            const container = document.getElementById('remindersList');
            
            if (reminders.length === 0) {
                container.innerHTML = '<p style="color: #666; font-style: italic;">No hay recordatorios programados</p>';
                return;
            }
            
            container.innerHTML = reminders.map(reminder => `
                <div class="reminder-item">
                    <div class="reminder-date">${new Date(reminder.date).toLocaleDateString('es-ES')}</div>
                    <div>Consulta ${reminder.type}</div>
                    <div class="reminder-actions">
                        <button class="btn-small btn-secondary" onclick="editReminder(${reminder.id})">‚úèÔ∏è Editar</button>
                        <button class="btn-small" onclick="deleteReminder(${reminder.id})" style="background: #e74c3c;">üóëÔ∏è Eliminar</button>
                    </div>
                </div>
            `).join('');
        }

        function deleteReminder(id) {
            if (confirm('¬øEliminar este recordatorio?')) {
                reminders = reminders.filter(r => r.id !== id);
                saveReminders();
                loadReminders();
            }
        }

        function editReminder(id) {
            const reminder = reminders.find(r => r.id === id);
            if (reminder) {
                document.getElementById('nextAppointment').value = reminder.date;
                document.getElementById('appointmentType').value = reminder.type;
                deleteReminder(id);
            }
        }

        function saveReminders() {
            try {
                localStorage.setItem('cmoVihReminders', JSON.stringify(reminders));
            } catch (e) {
                console.log('Recordatorios guardados en memoria');
            }
        }

        function uploadLogo() {
            const file = document.getElementById('logoUpload').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    appConfig.logo = e.target.result;
                    saveConfig();
                    alert('Logo cargado correctamente');
                };
                reader.readAsDataURL(file);
            }
        }

        function saveConfig() {
            appConfig.pharmacist = document.getElementById('pharmacistName').value;
            appConfig.center = document.getElementById('centerName').value;
            
            try {
                localStorage.setItem('cmoVihConfig', JSON.stringify(appConfig));
            } catch (e) {
                console.log('Configuraci√≥n guardada en memoria');
            }
            alert('Configuraci√≥n guardada correctamente');
        }

        function loadConfig() {
            try {
                const saved = localStorage.getItem('cmoVihConfig');
                if (saved) {
                    appConfig = JSON.parse(saved);
                    document.getElementById('pharmacistName').value = appConfig.pharmacist || '';
                    document.getElementById('centerName').value = appConfig.center || '';
                }
                
                const savedReminders = localStorage.getItem('cmoVihReminders');
                if (savedReminders) {
                    reminders = JSON.parse(savedReminders);
                }
            } catch (e) {
                console.log('Configuraci√≥n cargada desde memoria');
            }
        }
    </script>
</body>
</html>